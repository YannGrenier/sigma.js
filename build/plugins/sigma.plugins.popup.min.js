(function(){"use strict";function a(){var a,b,c={},d=arguments.length;for(a=d-1;a>=0;a--)for(b in arguments[a])c[b]=arguments[a][b];return c}function b(a,b,d,e,g){if(c(),f=document.createElement("div"),d.renderer){var h,i,j=Object.create(null);for(i in b)j[i]=b[i];h=d.renderer.call(a.graph,j,d.template),"string"==typeof h?f.innerHTML=h:f.appendChild(h)}else f.innerHTML=d.template;f.className=d.cssClass,f.style.position="absolute",f.style.left=e+"px",f.style.top=g+"px",setTimeout(function(){if(f){a.renderers[0].container.appendChild(f);var b=document.body.getBoundingClientRect(),c=f.getBoundingClientRect(),h=c.top-b.top,i=b.bottom-c.bottom,j=c.left-b.left,k=b.right-c.right;"top"===d.position?(f.className=d.cssClass+" top",f.style.left=e-c.width/2+"px",f.style.top=g-c.height+"px"):"bottom"===d.position?(f.className=d.cssClass+" bottom",f.style.left=e-c.width/2+"px",f.style.top=g+"px"):"left"===d.position?(f.className=d.cssClass+" left",f.style.left=e-c.width+"px",f.style.top=g-c.height/2+"px"):"right"===d.position&&(f.className=d.cssClass+" right",f.style.left=e+"px",f.style.top=g-c.height/2+"px"),d.autoadjust&&(c=f.getBoundingClientRect(),h=c.top-b.top,i=b.bottom-c.bottom,j=c.left-b.left,k=b.right-c.right,0>i?(f.className=d.cssClass,("top"===d.position||"bottom"===d.position)&&(f.className=d.cssClass+" top"),f.style.top=g-c.height+"px"):0>h&&(f.className=d.cssClass,("top"===d.position||"bottom"===d.position)&&(f.className=d.cssClass+" bottom"),f.style.top=g+"px"),0>k?(f.className=d.cssClass,("left"===d.position||"right"===d.position)&&(f.className=d.cssClass+" left"),f.style.left=e-c.width+"px"):0>j&&(f.className=d.cssClass,("left"===d.position||"right"===d.position)&&(f.className=d.cssClass+" right"),f.style.left=e+"px"))}},0)}function c(){f&&f.parentNode&&(f.parentNode.removeChild(f),f=null)}function d(){clearTimeout(g),g=!1,c()}function e(c,e){function k(a){a.preventDefault()}var l=a(e.stage,h.stage),m=a(e.node,h.node),n=a(e.edge,h.edge);if(sigma.classes.dispatcher.extend(this),this.close=function(){return d(),this},this.unbindEvents=function(){e.stage&&(c.unbind(l.show),c.unbind(l.hide),"doubleClickStage"!==l.show&&c.unbind("doubleClickStage")),e.node&&(c.unbind(m.show),c.unbind(m.hide),"doubleClickNode"!==m.show&&c.unbind("doubleClickNode")),e.edge&&(c.unbind(n.show),c.unbind(n.hide),"doubleClickEdge"!==n.show&&c.unbind("doubleClickEdge")),("rightClickNode"===m.show||"rightClickEdge"===n.show)&&c.renderers[0].container.removeEventListener("contextmenu",k)},e.stage){if(void 0!==e.stage.renderer&&"function"!=typeof e.stage.renderer)throw"The render of the stage popup must be a function.";if(void 0!==e.stage.position&&"top"!==e.stage.position&&"bottom"!==e.stage.position&&"left"!==e.stage.position&&"right"!==e.stage.position)throw"The value of options.position must be either: top, bottom, left, right.";c.bind(l.show,function(a){if("doubleClickStage"===l.show||!i){var d=a.data.captor.clientX,e=a.data.captor.clientY;clearTimeout(g),g=setTimeout(function(){b(c,null,l,d,e),j.dispatchEvent("shown")},l.delay)}}),c.bind(l.hide,function(){var a=f;d(),a&&j.dispatchEvent("hidden")}),"doubleClickStage"!==l.show&&c.bind("doubleClickStage",function(){d(),i=!0,j.dispatchEvent("hidden"),setTimeout(function(){i=!1},h.doubleClickDelay)})}if(e.node){if(void 0!==e.node.renderer&&"function"!=typeof e.node.renderer)throw"The render of the node popup must be a function.";if(void 0!==e.node.position&&"top"!==e.node.position&&"bottom"!==e.node.position&&"left"!==e.node.position&&"right"!==e.node.position)throw"The value of options.position must be either: top, bottom, left, right.";c.bind(m.show,function(a){if("doubleClickNode"===m.show||!i){var d=a.data.node||a.data.nodes[0],e=a.data.captor.clientX,f=a.data.captor.clientY;clearTimeout(g),g=setTimeout(function(){b(c,d,m,e,f),j.dispatchEvent("shown")},m.delay)}}),c.bind(m.hide,function(){var a=f;d(),a&&j.dispatchEvent("hidden")}),"doubleClickNode"!==m.show&&c.bind("doubleClickNode",function(){d(),i=!0,j.dispatchEvent("hidden"),setTimeout(function(){i=!1},h.doubleClickDelay)})}if(e.edge){if(void 0!==e.edge.renderer&&"function"!=typeof e.edge.renderer)throw"The render of the edge popup must be a function.";if(void 0!==e.edge.position&&"top"!==e.edge.position&&"bottom"!==e.edge.position&&"left"!==e.edge.position&&"right"!==e.edge.position)throw"The value of options.position must be either: top, bottom, left, right.";c.bind(n.show,function(a){if("doubleClickEdge"===n.show||!i){var d=a.data.edge||a.data.edges[0],e=a.data.captor.clientX,f=a.data.captor.clientY;clearTimeout(g),g=setTimeout(function(){b(c,d,n,e,f),j.dispatchEvent("shown")},n.delay)}}),c.bind(n.hide,function(){var a=f;d(),a&&j.dispatchEvent("hidden")}),"doubleClickEdge"!==n.show&&c.bind("doubleClickEdge",function(){d(),i=!0,j.dispatchEvent("hidden"),setTimeout(function(){i=!1},h.doubleClickDelay)})}("rightClickNode"===m.show||"rightClickEdge"===n.show)&&c.renderers[0].container.addEventListener("contextmenu",k)}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var f,g,h={stage:{show:"rightClickStage",hide:"clickStage",cssClass:"sigma-popup",position:"",autoadjust:!1,delay:0,template:"",renderer:null},node:{show:"clickNode",hide:"clickStage",cssClass:"sigma-popup",position:"",autoadjust:!1,delay:0,template:"",renderer:null},edge:{show:"clickEdge",hide:"clickStage",cssClass:"sigma-popup",position:"",autoadjust:!1,delay:0,template:"",renderer:null},doubleClickDelay:800},i=!1,j=null;sigma.plugins.popup=function(a,b){return j||(j=new e(a,b)),j},sigma.plugins.killPopup=function(){j instanceof e&&(j.unbindEvents(),j=null,f=null,g=null,i=!1)}}).call(window);