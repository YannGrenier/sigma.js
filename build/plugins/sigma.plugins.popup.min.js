(function(){"use strict";function a(){var a,b,c={},d=arguments.length;for(a=d-1;a>=0;a--)for(b in arguments[a])c[b]=arguments[a][b];return c}function b(a,b,d,f,g){if(c(),e=document.createElement("div"),d.renderer){var h,i,j=Object.create(null);for(i in b)j[i]=b[i];h=d.renderer.call(a.graph,j,d.template),"string"==typeof h?e.innerHTML=h:e.appendChild(h)}else e.innerHTML=d.template;e.className=d.cssClass,e.style.position="absolute",e.style.left=f+"px",e.style.top=g+"px",a.renderers[0].container.appendChild(e);var k=document.body.getBoundingClientRect(),l=e.getBoundingClientRect(),m=l.top-k.top,n=k.bottom-l.bottom,o=l.left-k.left,p=k.right-l.right;"top"===d.position?(e.className=d.cssClass+" top",e.style.left=f-(l.right-l.left)/2+"px",e.style.top=g-(l.bottom-l.top)+"px"):"bottom"===d.position?(e.className=d.cssClass+" bottom",e.style.left=f-(l.right-l.left)/2+"px",e.style.top=g+"px"):"left"===d.position?(e.className=d.cssClass+" left",e.style.left=f-(l.right-l.left)+"px",e.style.top=g-(l.bottom-l.top)/2+"px"):"right"===d.position&&(e.className=d.cssClass+" right",e.style.left=f+"px",e.style.top=g-(l.bottom-l.top)/2+"px"),l=e.getBoundingClientRect(),m=l.top-k.top,n=k.bottom-l.bottom,o=l.left-k.left,p=k.right-l.right,d.autoadjust&&(0>n?(e.className=d.cssClass,("top"===d.position||"bottom"===d.position)&&(e.className=d.cssClass+" top"),e.style.top=g-l.bottom+l.top+"px"):0>m&&(e.className=d.cssClass,("top"===d.position||"bottom"===d.position)&&(e.className=d.cssClass+" bottom"),e.style.top=g+"px"),0>p?(e.className=d.cssClass,("left"===d.position||"right"===d.position)&&(e.className=d.cssClass+" left"),e.style.left=f-l.right+l.left+"px"):0>o&&(e.className=d.cssClass,("left"===d.position||"right"===d.position)&&(e.className=d.cssClass+" right"),e.style.left=f+"px"))}function c(){e&&e.parentNode&&(e.parentNode.removeChild(e),e=null)}function d(){clearTimeout(f),f=!1,c()}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins"),sigma.utils.pkg("sigma.plugins.popup");var e,f,g={stage:{show:"rightClickStage",hide:"clickStage",cssClass:"sigma-popup",position:"",autoadjust:!1,delay:0,template:"",renderer:null},node:{show:"clickNode",hide:"clickStage",cssClass:"sigma-popup",position:"",autoadjust:!1,delay:0,template:"",renderer:null},edge:{show:"clickEdge",hide:"clickStage",cssClass:"sigma-popup",position:"",autoadjust:!1,delay:0,template:"",renderer:null},doubleClickDelay:800},h=!1;sigma.plugins.popup=function(c,i){var j=this,k=a(i.stage,g.stage),l=a(i.node,g.node),m=a(i.edge,g.edge);if(sigma.classes.dispatcher.extend(this),i.stage){if(void 0!==i.stage.renderer&&"function"!=typeof i.stage.renderer)throw"The render of the stage popup must be a function.";if(void 0!==i.stage.position&&"top"!==i.stage.position&&"bottom"!==i.stage.position&&"left"!==i.stage.position&&"right"!==i.stage.position)throw"The value of options.position must be either: top, bottom, left, right.";c.bind(k.show,function(a){if("doubleClickStage"===k.show||!h){var d=a.data.captor.clientX,e=a.data.captor.clientY;clearTimeout(f),f=setTimeout(function(){b(c,null,k,d,e),j.dispatchEvent("shown")},k.delay)}}),c.bind(k.hide,function(){var a=e;d(),a&&j.dispatchEvent("hidden")}),"doubleClickStage"!==k.show&&c.bind("doubleClickStage",function(){d(),h=!0,j.dispatchEvent("hidden"),setTimeout(function(){h=!1},g.doubleClickDelay)})}if(i.node){if(void 0!==i.node.renderer&&"function"!=typeof i.node.renderer)throw"The render of the node popup must be a function.";if(void 0!==i.node.position&&"top"!==i.node.position&&"bottom"!==i.node.position&&"left"!==i.node.position&&"right"!==i.node.position)throw"The value of options.position must be either: top, bottom, left, right.";c.bind(l.show,function(a){if("doubleClickNode"===l.show||!h){var d=a.data.node||a.data.nodes[0],e=a.data.captor.clientX,g=a.data.captor.clientY;clearTimeout(f),f=setTimeout(function(){b(c,d,l,e,g),j.dispatchEvent("shown")},l.delay)}}),c.bind(l.hide,function(){var a=e;d(),a&&j.dispatchEvent("hidden")}),"doubleClickNode"!==l.show&&c.bind("doubleClickNode",function(){d(),h=!0,j.dispatchEvent("hidden"),setTimeout(function(){h=!1},g.doubleClickDelay)})}if(i.edge){if(void 0!==i.edge.renderer&&"function"!=typeof i.edge.renderer)throw"The render of the edge popup must be a function.";if(void 0!==i.edge.position&&"top"!==i.edge.position&&"bottom"!==i.edge.position&&"left"!==i.edge.position&&"right"!==i.edge.position)throw"The value of options.position must be either: top, bottom, left, right.";c.bind(m.show,function(a){if("doubleClickEdge"===m.show||!h){var d=a.data.edge||a.data.edges[0],e=a.data.captor.clientX,g=a.data.captor.clientY;clearTimeout(f),f=setTimeout(function(){b(c,d,m,e,g),j.dispatchEvent("shown")},m.delay)}}),c.bind(m.hide,function(){var a=e;d(),a&&j.dispatchEvent("hidden")}),"doubleClickEdge"!==m.show&&c.bind("doubleClickEdge",function(){d(),h=!0,j.dispatchEvent("hidden"),setTimeout(function(){h=!1},g.doubleClickDelay)})}return("rightClickNode"===l.show||"rightClickEdge"===m.show)&&c.renderers[0].container.addEventListener("contextmenu",function(a){a.preventDefault()}),this}}).call(window);